<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>User Login â€” DriveMatrix</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

<style>
:root{
  --glass-bg: rgba(255,255,255,0.12);
  --glass-border: rgba(255,255,255,0.15);
}

body{
  margin:0;
  min-height:100vh;
  font-family: Poppins, sans-serif;
  background-image: url('D:/Images/25.jpg');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  background-attachment: fixed;
  display:flex;
  justify-content:center;
  align-items:center;
}

/* NAVBAR */
.nav-glass{
  background: rgba(0,0,0,0.35);
  backdrop-filter: blur(6px);
  border-bottom: 1px solid rgba(255,255,255,0.06);
}
.navbar-brand{ font-weight:700; }

/* glass cards */
.card-glass{
  background: rgba(255,255,255,0.10);
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.08);
  box-shadow: 0 8px 18px rgba(0,0,0,0.2);
}

/* login card */
.login-card{
  width: 380px;
  background: rgba(255,255,255,0.92);
  padding: 22px;
  border-radius: 12px;
  color: #333;
  box-shadow: 0 8px 18px rgba(0,0,0,0.2);
}

</style>
</head>

<body>
  <div class="d-flex justify-content-center align-items-center vh-100">
    <div class="login-card p-4">
      <div class="text-center mb-3">
        <i class="fa-solid fa-car fa-2x text-primary"></i>
        <h3 class="mt-2">Login</h3>
      </div>

      <form id="loginForm">
	<div class="mb-2">
            <select id="role" class="form-control">
                <option>User</option>
                <option>Admin</option>
                <option>Driver</option>
            </select>
        </div>
        <div class="mb-2">
          <input type="text" id="email" class="form-control" placeholder="Email or Mobile">
        </div>
        <div class="mb-2">
          <input type="password" id="password" class="form-control" placeholder="Password">
        </div>
	 <div class="mb-2 text-center">
    <a href="forgotpassword.html" class="small">Forgot Password?</a>
  </div>
        <button class="btn btn-primary w-100" type="submit">Login</button>
      </form>

      <div class="mt-3 text-center">
        <small>Don't have an account? <a href="signup.html">Sign up</a></small>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
  <script>
// Fill footer year
document.addEventListener('DOMContentLoaded', ()=>{
  const y = new Date().getFullYear();
  const el = document.getElementById('year');
  if(el) el.innerText = y;

  // Example: we try to fetch /api/stats (backend) to show numbers
  fetch('/api/stats').then(r=>r.json()).then(d=>{
    if(d){
      document.getElementById('totalCars').innerText = d.cars || 0;
      document.getElementById('activeBookings').innerText = d.bookings || 0;
      document.getElementById('totalDrivers').innerText = d.drivers || 0;
      document.getElementById('revenue').innerText = d.revenue || 'â‚¹0';
    }
  }).catch(()=>{});
});
  document.getElementById('loginForm').addEventListener('submit', async (e)=>{
    e.preventDefault();

    const role = document.getElementById('role').value.trim();
    const email = document.getElementById('email').value.trim();
    const password = document.getElementById('password').value.trim();

    if(!email || !password) 
        return alert('Enter credentials');

    try{
      const res = await fetch("http://127.0.0.1:8000/api/auth/login",{
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify({ email, password, role })
      });

      const data = await res.json();

      if(res.ok){
        localStorage.setItem('token', data.access_token);
        localStorage.setItem('role', role);

        alert('Login success');

        // ðŸ”¥ ROLE-WISE REDIRECT
        if(role === "Admin"){
          window.location.href = "admindashboard.html";
        } 
        else if(role === "Driver"){
          window.location.href = "driverdashboard.html";
        }
        else {
          window.location.href = "Userdashboard.html";
	  window.location.href = "home.html";
        }

      } else {
        alert(data.error || 'Login failed');
      }
    }
    catch(err){ 
      alert('Network error'); 
    }
  });
</script>

</body>
</html>